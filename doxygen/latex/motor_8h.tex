\hypertarget{motor_8h}{}\doxysection{lowlevel/include/motor.h File Reference}
\label{motor_8h}\index{lowlevel/include/motor.h@{lowlevel/include/motor.h}}


This implements the functions required to pilot the propulsion motors of the robot ~\newline
  


{\ttfamily \#include $<$libopencm3/stm32/timer.\+h$>$}\newline
{\ttfamily \#include \char`\"{}timer.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}gpio.\+h\char`\"{}}\newline
\doxysubsection*{Macros}
\begin{DoxyCompactItemize}
\item 
\#define \mbox{\hyperlink{motor_8h_aaf381d8dd460b5a2ff55eea8da02eedb}{P\+W\+M\+\_\+\+P\+R\+E\+S\+C\+A\+LE}}~(64)
\item 
\#define \mbox{\hyperlink{motor_8h_aacaca0988244bd3a888ca5befa89f44b}{P\+W\+M\+\_\+\+P\+E\+R\+I\+OD}}~(20000)
\item 
\#define {\bfseries M\+O\+T\+O\+R\+\_\+\+T\+I\+M\+\_\+\+R\+CC}~R\+C\+C\+\_\+\+T\+I\+M3
\item 
\#define {\bfseries M\+O\+T\+O\+R\+\_\+\+T\+IM}~T\+I\+M3
\item 
\#define {\bfseries M\+O\+T\+O\+R\+\_\+\+A\+\_\+\+G\+P\+I\+O\+\_\+\+R\+C\+C\+\_\+\+EN}~R\+C\+C\+\_\+\+G\+P\+I\+OA
\item 
\#define {\bfseries M\+O\+T\+O\+R\+\_\+\+A\+\_\+\+P\+O\+R\+T\+\_\+\+EN}~G\+P\+I\+OA
\item 
\#define {\bfseries M\+O\+T\+O\+R\+\_\+\+A\+\_\+\+P\+I\+N\+\_\+\+EN}~G\+P\+I\+O4
\item 
\#define {\bfseries M\+O\+T\+O\+R\+\_\+\+A\+\_\+\+AF}~G\+P\+I\+O\+\_\+\+A\+F2
\item 
\#define {\bfseries M\+O\+T\+O\+R\+\_\+\+A\+\_\+\+O\+C\+\_\+\+ID}~T\+I\+M\+\_\+\+O\+C2
\item 
\#define {\bfseries M\+O\+T\+O\+R\+\_\+\+A\+\_\+\+O\+C\+\_\+\+M\+O\+DE}~T\+I\+M\+\_\+\+O\+C\+M\+\_\+\+P\+W\+M1
\item 
\#define {\bfseries M\+O\+T\+O\+R\+\_\+\+A\+\_\+\+G\+P\+I\+O\+\_\+\+R\+C\+C\+\_\+\+D\+IR}~R\+C\+C\+\_\+\+G\+P\+I\+OA
\item 
\#define {\bfseries M\+O\+T\+O\+R\+\_\+\+A\+\_\+\+P\+O\+R\+T\+\_\+\+D\+IR}~G\+P\+I\+OA
\item 
\#define {\bfseries M\+O\+T\+O\+R\+\_\+\+A\+\_\+\+P\+I\+N\+\_\+\+D\+IR}~G\+P\+I\+O3
\item 
\#define {\bfseries M\+O\+T\+O\+R\+\_\+\+A\+\_\+\+I\+N\+I\+T\+\_\+\+D\+IR}~0
\item 
\#define {\bfseries M\+O\+T\+O\+R\+\_\+\+B\+\_\+\+G\+P\+I\+O\+\_\+\+R\+C\+C\+\_\+\+EN}~R\+C\+C\+\_\+\+G\+P\+I\+OA
\item 
\#define {\bfseries M\+O\+T\+O\+R\+\_\+\+B\+\_\+\+P\+O\+R\+T\+\_\+\+EN}~G\+P\+I\+OA
\item 
\#define {\bfseries M\+O\+T\+O\+R\+\_\+\+B\+\_\+\+P\+I\+N\+\_\+\+EN}~G\+P\+I\+O6
\item 
\#define {\bfseries M\+O\+T\+O\+R\+\_\+\+B\+\_\+\+AF}~G\+P\+I\+O\+\_\+\+A\+F2
\item 
\#define {\bfseries M\+O\+T\+O\+R\+\_\+\+B\+\_\+\+O\+C\+\_\+\+ID}~T\+I\+M\+\_\+\+O\+C1
\item 
\#define {\bfseries M\+O\+T\+O\+R\+\_\+\+B\+\_\+\+O\+C\+\_\+\+M\+O\+DE}~T\+I\+M\+\_\+\+O\+C\+M\+\_\+\+P\+W\+M1
\item 
\#define {\bfseries M\+O\+T\+O\+R\+\_\+\+B\+\_\+\+G\+P\+I\+O\+\_\+\+R\+C\+C\+\_\+\+D\+IR}~R\+C\+C\+\_\+\+G\+P\+I\+OA
\item 
\#define {\bfseries M\+O\+T\+O\+R\+\_\+\+B\+\_\+\+P\+O\+R\+T\+\_\+\+D\+IR}~G\+P\+I\+OA
\item 
\#define {\bfseries M\+O\+T\+O\+R\+\_\+\+B\+\_\+\+P\+I\+N\+\_\+\+D\+IR}~G\+P\+I\+O7
\item 
\#define {\bfseries M\+O\+T\+O\+R\+\_\+\+B\+\_\+\+I\+N\+I\+T\+\_\+\+D\+IR}~0
\end{DoxyCompactItemize}
\doxysubsection*{Enumerations}
\begin{DoxyCompactItemize}
\item 
enum \mbox{\hyperlink{motor_8h_aaf6c1dcd424d3ac24d7139472d592dc4}{motor\+\_\+sel}} \{ {\bfseries M\+O\+T\+O\+R\+\_\+A}, 
{\bfseries M\+O\+T\+O\+R\+\_\+B}
 \}
\begin{DoxyCompactList}\small\item\em enum of the two motors of the robot to choose which one will be piloted (with function motor\+\_\+set) \end{DoxyCompactList}\end{DoxyCompactItemize}
\doxysubsection*{Functions}
\begin{DoxyCompactItemize}
\item 
void \mbox{\hyperlink{motor_8h_adf003d086ffc3ea127fb361097b6bb44}{motor\+\_\+setup}} ()
\begin{DoxyCompactList}\small\item\em This function initialize the timers and G\+P\+I\+Os to pilot the propulsion motors in our setup by P\+WM + the G\+P\+I\+Os for the direction. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{motor_8h_a0aa6c302c8189571af7af83c07313a7e}{motor\+\_\+set}} (enum \mbox{\hyperlink{motor_8h_aaf6c1dcd424d3ac24d7139472d592dc4}{motor\+\_\+sel}} sel, int8\+\_\+t value)
\begin{DoxyCompactList}\small\item\em This function pilot the sel (M\+O\+T\+O\+R\+\_\+A or M\+O\+T\+O\+R\+\_\+B) with a value between -\/100(backward full speed) and +100 (forward full speed) \end{DoxyCompactList}\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
This implements the functions required to pilot the propulsion motors of the robot ~\newline
 

This file is part of cdfr2020\+Base\+Roulante\+Rework

\begin{DoxyDate}{Date}
06/2020 ~\newline

\end{DoxyDate}
Licence \+:

Robotronik Phelma \begin{DoxyAuthor}{Author}
N\+P\+Xav Benano Trukbidule 
\end{DoxyAuthor}


\doxysubsection{Macro Definition Documentation}
\mbox{\Hypertarget{motor_8h_aacaca0988244bd3a888ca5befa89f44b}\label{motor_8h_aacaca0988244bd3a888ca5befa89f44b}} 
\index{motor.h@{motor.h}!PWM\_PERIOD@{PWM\_PERIOD}}
\index{PWM\_PERIOD@{PWM\_PERIOD}!motor.h@{motor.h}}
\doxysubsubsection{\texorpdfstring{PWM\_PERIOD}{PWM\_PERIOD}}
{\footnotesize\ttfamily \#define P\+W\+M\+\_\+\+P\+E\+R\+I\+OD~(20000)}

We need a 50 Hz period (1000 / 20ms = 50), thus divide 100000 by 50 = 20000 (us). \mbox{\Hypertarget{motor_8h_aaf381d8dd460b5a2ff55eea8da02eedb}\label{motor_8h_aaf381d8dd460b5a2ff55eea8da02eedb}} 
\index{motor.h@{motor.h}!PWM\_PRESCALE@{PWM\_PRESCALE}}
\index{PWM\_PRESCALE@{PWM\_PRESCALE}!motor.h@{motor.h}}
\doxysubsubsection{\texorpdfstring{PWM\_PRESCALE}{PWM\_PRESCALE}}
{\footnotesize\ttfamily \#define P\+W\+M\+\_\+\+P\+R\+E\+S\+C\+A\+LE~(64)}

Prescale 64000000 Hz system clock by 64 = 1000000 Hz. 

\doxysubsection{Enumeration Type Documentation}
\mbox{\Hypertarget{motor_8h_aaf6c1dcd424d3ac24d7139472d592dc4}\label{motor_8h_aaf6c1dcd424d3ac24d7139472d592dc4}} 
\index{motor.h@{motor.h}!motor\_sel@{motor\_sel}}
\index{motor\_sel@{motor\_sel}!motor.h@{motor.h}}
\doxysubsubsection{\texorpdfstring{motor\_sel}{motor\_sel}}
{\footnotesize\ttfamily enum \mbox{\hyperlink{motor_8h_aaf6c1dcd424d3ac24d7139472d592dc4}{motor\+\_\+sel}}}



enum of the two motors of the robot to choose which one will be piloted (with function motor\+\_\+set) 



\doxysubsection{Function Documentation}
\mbox{\Hypertarget{motor_8h_a0aa6c302c8189571af7af83c07313a7e}\label{motor_8h_a0aa6c302c8189571af7af83c07313a7e}} 
\index{motor.h@{motor.h}!motor\_set@{motor\_set}}
\index{motor\_set@{motor\_set}!motor.h@{motor.h}}
\doxysubsubsection{\texorpdfstring{motor\_set()}{motor\_set()}}
{\footnotesize\ttfamily void motor\+\_\+set (\begin{DoxyParamCaption}\item[{enum \mbox{\hyperlink{motor_8h_aaf6c1dcd424d3ac24d7139472d592dc4}{motor\+\_\+sel}}}]{sel,  }\item[{int8\+\_\+t}]{value }\end{DoxyParamCaption})}



This function pilot the sel (M\+O\+T\+O\+R\+\_\+A or M\+O\+T\+O\+R\+\_\+B) with a value between -\/100(backward full speed) and +100 (forward full speed) 


\begin{DoxyParams}{Parameters}
{\em sel} & The motor that will be piloted (eg M\+O\+T\+O\+R\+\_\+A) \\
\hline
{\em value} & value is between -\/100 and +100, controls the speed and direction of the motor sel (eg +54) \\
\hline
\end{DoxyParams}
\begin{DoxyRefDesc}{Todo}
\item[\mbox{\hyperlink{todo__todo000001}{Todo}}]we chosse that 0 is forward and 1 is backward, it should be defined in a macro and adjustable for the motors \end{DoxyRefDesc}
\mbox{\Hypertarget{motor_8h_adf003d086ffc3ea127fb361097b6bb44}\label{motor_8h_adf003d086ffc3ea127fb361097b6bb44}} 
\index{motor.h@{motor.h}!motor\_setup@{motor\_setup}}
\index{motor\_setup@{motor\_setup}!motor.h@{motor.h}}
\doxysubsubsection{\texorpdfstring{motor\_setup()}{motor\_setup()}}
{\footnotesize\ttfamily void motor\+\_\+setup (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}



This function initialize the timers and G\+P\+I\+Os to pilot the propulsion motors in our setup by P\+WM + the G\+P\+I\+Os for the direction. 

